

# 协议层次及其服务模型

## 协议分层

网络设计者以分层（layer）的方式组织协议以及实现这些协议的网络硬件和软件。

各层的所有协议被称为协议栈（protocol stack）。因特网的协议栈由5个层次组成，自顶向下分别是：应用层、运输层、网络层、链路层和物理层。

应用层

应用层是网络应用程序及他们的应用层协议存留的地方。因特网的应用层包括许多协议，

HTTP（它提供了Web文档的请求和传送）
SMTP（它提供了电子邮件报文的传输）
FTP（它提供两个端系统之间的文件传送）
DNS（将 www.sample.com 端系统名字转换为32比特网络地址）。

应用层协议分布在多个端系统上，一个端系统中的应用程序使用协议与另一个端系统中的应用程序交换信息的分组。把这种位于应用层的信息分组称为报文（message）。

运输层

因特网的运输层在应用程序端点之间传送应用层报文。

两个运输协议TCP和UDP，都能运输应用层报文。

TCP向它的应用程序提供了面向连接的服务。这种服务包括了应用层报文向目的地的确保传递和流量控制（即发送方/接收方速率匹配）。TCP也将长报文划分为短报文，并提供拥塞控制机制，因此当网络拥塞时，源抑制其传输速率。

UDP协议向它的应用程序提供无连接服务。这是一种不提供不必要服务的服务，没有可靠性，没有流量控制，也没有拥塞控制。

运输层分组称为报文段（segment）。

网络层

因特网的网络层负责将称为数据报（datagram）的网络层分组从一台主机移动到另一台主机。在一台源主机中的因特网运输层协议（TCP或UDP）向网络层递交运输层报文段和目的地址，就像你通过邮政服务寄信件时提供一个目的地址一样。

因特网的网络层包括著名的IP协议，该协议定义了在数据报中的各个字段以及端系统和路由器如何作用于这些字段。仅有一个IP协议，所有具有网络层的因特网组件必须运行IP协议。因特网的网络层也包括决定路由选择协议，它使得数据报根据该路由从源传输到目的地。因特网具有许多路由选择协议。

链路层

因特网的网络层通过源和目的地之间的一系列路由器路由数据报。为了将分组从一个结点（主机或路由器）移动到路径上的下一个结点，网络层必须依靠该链路层的服务。特别是在每个结点，网络层将数据报下传给链路层，链路层沿着路径将数据报传递给下一个结点。在下个结点，链路层将数据报上传给网络层。

数据报从源到目的地传送通常需要经过几条链路，一个数据可能被沿途不同链路上的不同链路层协议处理。一个数据报可能被一段链路上的以太网和下一段链路上的PPP所处理。网络层将受到来自每个不同的链路层协议的不同服务。链路层分组称为帧（frame）。

物理层

链路层的任务是将整个帧从一个网络元素移动到该邻近的网络元素，而物理层的任务是将该帧中的一个一个比特从一个结点移动到下一个结点。

## OSI模型

20世纪70年代后期，国际标准化组织（ISO）提出计算机网络应组织为大约7层，称为开放系统互连（OSI）模型 [ISO 2012]。

OSI参考模型的7层是：应用层、表示层、会话层、运输层、网络层、数据链路层和物理层。这些层次中，5层的功能大致与它们名字类似的因特网对应层的相同。所以，我们来考虑OSI参考模型中附加的两个层，即表示层和会话层。表示层的作用是使通信的应用程序能够解释交换数据的含义。这些服务包括数据压缩和数据加密以及数据描述。会话层提供了数据交换定界和同步功能，包括了建立检查点和恢复方案的方法。

因特网缺少了在OSI参考模型中建立的两个层次，这留给了应用程序开发者处理。应用程序开发者决定一个服务是否是重要的，如果该服务重要，应用程序开发者就应该在应用程序中构建该功能。

## 封装

封装（encapsulation）。在发送主机端，一个应用层报文（application-layer message）被传送给运输层。在最简单的情况下，运输层收取包报文并附上附加信息，该首部将被接收端的运输层使用。应用层报文和运输层首部信息一道构成了运输层报文段（transport-layer segment）。运输层报文段因此封装了应用层报文。附加的信息也许包括了下列信息：如允许接收端运输层向上向适当的应用程序交付报文的信息；如差错检测位信息，该信息让接收方能够判断报文中的比特是否在途中已被改变。运输层则向网络层传递该报文段，网络层增加了如源和目的端系统地址等网络层首部信息，产生了网络层数据报（network-layer datagram）。该数据报接下来被传递给链路层，链路层增加它自己的链路层首部信息并创建链路层帧（link-layer frame）。所以，我们看到在每一层，一个分组具有两种类型的字段：首部字段和有效载荷字段（payload field）。有效载荷通常是来自上一层的分组。

# 面对攻击的网络

一旦恶意软件感染我们的设备，就能够做各种不正当的事情，包括删除我们的文件，安装间谍软件来收集我们的隐私信息，如社会保险号、口令和击键，然后将这些发送给坏家伙。我们的受害主机也可能成为数以千计的类似受害设备网络中的一员，它们被统称为僵尸网络（botnet），利用僵尸网络控制并有效地对目标主机展开垃圾邮件分发或分布式拒绝服务供给。

自我复制（self-replicating）：一旦感染一台主机，就会从那台主机寻求进入更多的主机。以这种方式，自我复制的恶意软件能够指数式地快速扩散。恶意软件能够以病毒或蠕虫的形式扩散。

病毒（virus）是一种需要某种形式的用户交互来感染用户设备的恶意软件。

蠕虫（worm）是一种无需任何明显用户交互就能进入设备的恶意软件。

拒绝服务供给（Denial-of-Service （Dos） attack）。顾名思义，DoS供给使得网络、主机或其它基础设施部分不能由合法用户所使用。

大多数因特网DoS供给属于下列三种类型之一：

- 弱点攻击。这涉及向一台目标主机上运行的易受攻击的应用程序或操作系统发送制作精细的报文。如果适当顺序的多个分组发送给一个易受攻击的应用程序或操作系统，该服务器可能停止运行，或者更糟糕的是主机可能崩溃。
- 带宽洪泛。攻击者向目标主机发送大量的分组，分组数量之多使得目标的接入链路变得拥塞，使得合法的分组无法到达服务器。
- 连接洪泛。攻击者在目标主机中创建大量的半开或全开TCP连接。该主机因这些伪造的连接而陷入困境，并停止接受合法的连接。

带宽洪泛中，分布式DoS（Distributed DoS，DDoS）中，攻击者控制多个源并让每个源向目标猛烈发送流量。使用这种方式，为了削弱或损坏服务器，遍及所有受控源的聚合速率需要大约R的能力。

记录每个流经的分组副本的被动接收机被称为分组嗅探器（packet sniffer）。

将虚假的源地址作为真实的，进而执行某些嵌入在该分组内容中的命令。将具有虚假源地址的分组注入因特网的能力被称为IP哄骗（IP spoofing），而它只是一个用户能够冒充另一个用户的许多方式中的一种。

# 计算机网络和因特网的历史

一、分组交换的发展：1961~1972

二、专用网络和互联网络：1972~1980

三、网络的激增：1980~1990

四、因特网爆炸：20世纪90年代